# AIとの共同開発プロセスガイド

## 概要

このドキュメントでは、人狼ゲームGM支援ライブラリの開発におけるAIと人間の効果的な共同作業プロセスについて説明します。段階的な開発アプローチとモジュール別の実装戦略を通じて、高品質なコードを効率的に作成する方法を紹介します。

## 1. 共同開発の基本原則

### 1.1 段階的な実装

大きな機能を一度に実装するのではなく、小さな単位に分割して段階的に実装します：

1. **コア機能の最小実装**: まず基本的な機能のみを実装
2. **テストによる検証**: 実装ごとにテストで動作確認
3. **機能の拡張**: 基本機能が安定してから拡張機能を追加
4. **リファクタリング**: 全体的な設計の見直しと最適化

### 1.2 モジュール駆動開発

依存関係を考慮したモジュール単位での開発を行います：

1. **コアモジュールから開始**: EventSystem → ErrorSystem → Common/Utils
2. **基本ドメインモデル**: PlayerModel → RoleModel → PhaseModel
3. **サービスレイヤー**: 各Managerクラス
4. **統合レイヤー**: 全体を統合するGameManager

### 1.3 コミュニケーションパターン

AIとの効果的なコミュニケーションパターン：

- **明確な要件定義**: 実装する機能と期待する結果を明確に説明
- **コンテキストの共有**: 関連するコードや設計ドキュメントへの参照
- **段階的なフィードバック**: 一度に多くの変更を求めるのではなく、段階的に改善
- **具体的な質問**: 抽象的な質問よりも具体的な質問を優先

## 2. AIとの共同作業モデル

### 2.1 モジュール実装の基本フロー

```
人間: モジュールの要件と設計を定義
  ↓
AI: テストケースを作成
  ↓
人間: テストケースをレビュー・承認
  ↓
AI: 実装コードを作成
  ↓
人間: コードをレビュー・フィードバック
  ↓
AI: コードを改善
  ↓
人間: 最終承認・統合
```

### 2.2 リクエスト構造のテンプレート

AIへの効果的なリクエストテンプレート：

```
# [モジュール名]の実装リクエスト

## 目的
[このモジュールの目的と役割を簡潔に説明]

## 実装範囲
- [機能1]
- [機能2]
- [機能3]

## 技術仕様
- 対象ファイル: [ファイルパス]
- 依存モジュール: [依存するモジュールリスト]
- 実装言語: JavaScript ES6

## 参考情報
- 設計ドキュメント: [ドキュメントへの参照]
- 関連するコード: [関連コードへの参照]

## 追加の制約条件
- [その他の考慮事項や制約]
```

### 2.3 コードレビューガイドライン

AIが生成したコードのレビュー観点：

- **設計との整合性**: 設計文書の意図が正確に実装されているか
- **エラー処理**: 例外処理とエラーハンドリングが適切か
- **テストカバレッジ**: すべての機能と境界条件がテストでカバーされているか
- **コメント・ドキュメント**: 適切なJSDocコメントが含まれているか
- **コードの簡潔さ**: 不必要な複雑さがないか
- **ベストプラクティス**: JavaScript/ES6のベストプラクティスに従っているか

## 3. モジュール別開発アプローチ

### 3.1 コアモジュール開発

#### EventSystem

```
# EventSystemモジュールの実装リクエスト

## 目的
イベント駆動アーキテクチャの基盤となるイベント管理システムを実装する

## 実装範囲
- イベントリスナーの登録（on）
- 一度だけ実行されるリスナーの登録（once）
- イベントの発火（emit）
- リスナーの削除（off）
- 階層的イベント名のサポート

## 技術仕様
- 対象ファイル: src/core/event/EventSystem.js
- テストファイル: src/core/event/__tests__/EventSystem.test.js
- エクスポート形式: ES6 class

## 参考情報
- 設計ドキュメント: docs/werewolf-architecture.md の「4.1.2 EventSystem」セクション
```

#### ErrorSystem

```
# ErrorSystemモジュールの実装リクエスト

## 目的
標準化されたエラー処理と検証機能を提供するシステムを実装する

## 実装範囲
- エラーカタログの定義
- エラー処理ハンドラー
- 入力検証ユーティリティ

## 技術仕様
- 対象ファイル: 
  - src/core/error/ErrorCatalog.js
  - src/core/error/ErrorHandler.js
  - src/core/error/Validator.js
  - src/core/error/index.js
- 依存モジュール: EventSystem

## 参考情報
- 設計ドキュメント: docs/werewolf-architecture.md の「4.1.3 ErrorSystem」セクション
```

#### Common/Utils

```
# Common/Utilsモジュールの実装リクエスト

## 目的
ライブラリ全体で使用される共通ユーティリティ関数を提供する

## 実装範囲
- バリデーション関数
- コレクション操作関数
- ゲームロジック関連ユーティリティ

## 技術仕様
- 対象ファイル: 
  - src/core/common/utils.js
  - src/core/common/index.js
- 実装方式: 純粋関数のコレクション

## 参考情報
- 設計ドキュメント: docs/implementation/common-utils.md
```

### 3.2 ドメインモデル開発

#### PlayerModel

```
# PlayerModelモジュールの実装リクエスト

## 目的
プレイヤー情報を表現するデータモデルを実装する

## 実装範囲
- Playerクラス
- PlayerFactoryクラス
- PlayerCollectionクラス

## 技術仕様
- 対象ファイル: 
  - src/domain/player/Player.js
  - src/domain/player/PlayerFactory.js
  - src/domain/player/PlayerCollection.js
  - src/domain/player/index.js
- 依存モジュール: Common/Utils, ErrorSystem

## 参考情報
- 設計ドキュメント: docs/implementation/domain-models.md の「1. PlayerModel」セクション
```

### 3.3 サービスレイヤー開発

```
# PlayerManagerの実装リクエスト

## 目的
プレイヤーの追加、削除、状態管理を行うサービスを実装する

## 実装範囲
- プレイヤーの追加/削除機能
- プレイヤー状態の管理
- イベント発火との連携

## 技術仕様
- 対象ファイル: src/service/player/PlayerManager.js
- 依存モジュール: PlayerModel, EventSystem, ErrorSystem, Common/Utils

## 参考情報
- 設計ドキュメント: docs/module-structure-design-updated.md の「4.3.1 PlayerManager」セクション
```

## 4. AIとの効果的な共同作業のコツ

### 4.1 明確な指示

- **具体的な要件**: 抽象的な指示より具体的な指示を優先
- **優先順位**: 必須機能と任意機能を明確に区別
- **コンテキスト**: 関連するコードと設計情報を共有

例：
```
次のPlayerManagerクラスを実装してください。特に以下の機能を優先してください：

1. プレイヤーの追加機能（必須）
2. プレイヤーの削除機能（必須）
3. 生存プレイヤーのフィルタリング（必須）
4. プレイヤー状態の変更通知（オプション）

EventSystemを使用して、プレイヤーの追加/削除/状態変更時にイベントを発火してください。
```

### 4.2 段階的なフィードバック

- **1つずつの問題点**: 一度に多くの修正を求めない
- **具体的な改善案**: 問題だけでなく具体的な改善案も提示
- **優先度の明示**: 重要な問題と小さな改善点を区別

例：
```
実装ありがとうございます。いくつか修正点があります：

1. [重要] プレイヤー追加時のID重複チェックが不足しています。addPlayerメソッドで既存IDをチェックしてください。
2. [重要] イベント発火の引数がドキュメントと一致していません。player.addイベントには{playerId, name}を含めてください。
3. [軽微] getPlayerメソッドでのエラーメッセージをより具体的にするとよいでしょう。
```

### 4.3 テスト駆動開発の促進

- **先にテストを依頼**: 実装前にテストケースを作成
- **テストシナリオの明示**: 期待する動作を明確にするテストを指定
- **エッジケースの検証**: 境界条件や異常系のテストを含める

例：
```
PlayerManagerクラスのテストケースを先に作成してください。以下のシナリオをカバーするテストを含めてください：

1. プレイヤーが正常に追加できることを確認
2. 同じIDのプレイヤーを追加しようとするとエラーになることを確認
3. 存在するプレイヤーを削除できることを確認
4. 存在しないプレイヤーを削除しようとするとエラーになることを確認
5. 生存プレイヤーのみが正しくフィルタリングされることを確認
```

### 4.4 コードレビューの効率化

- **レビュー観点の明示**: 特に注目すべき点を明確に
- **コード品質のフィードバック**: 良い実装への肯定的フィードバック
- **改善の優先順位**: 必須の修正と推奨改善を区別

例：
```
PlayerManagerの実装をレビューしました。全体的に良い実装ですが、いくつか改善点があります：

良い点：
- エラー処理が適切に実装されています
- イベント発火のタイミングが正確です
- テストカバレッジが十分です

改善すべき点：
1. [必須] removePlayerメソッドでプレイヤーが存在しない場合のエラー処理
2. [推奨] getPlayersByRoleメソッドのパフォーマンス最適化
3. [提案] メソッドのJSDocコメントの充実
```

## 5. 共同開発の進め方

### 5.1 開発ロードマップ

1. **フェーズ1: コア基盤**
   - EventSystem
   - ErrorSystem
   - Common/Utils

2. **フェーズ2: ドメインモデル**
   - PlayerModel
   - RoleModel
   - PhaseModel

3. **フェーズ3: サービスレイヤー**
   - PlayerManager
   - RoleManager
   - PhaseManager

4. **フェーズ4: 応用機能**
   - ActionModel/Manager
   - VoteModel/Manager
   - VictoryModel/Manager

5. **フェーズ5: 統合と拡張**
   - GameManager
   - ExtensionManager

### 5.2 各フェーズの作業フロー

1. **計画**
   - 実装するモジュールの優先順位決定
   - 実装範囲と技術仕様の定義

2. **テスト作成**
   - AIにテストケースの作成を依頼
   - テストケースのレビューと承認

3. **実装**
   - AIに実装を依頼
   - コードレビューとフィードバック
   - 改善と最終承認

4. **統合**
   - モジュールの統合テスト
   - ドキュメントの更新

5. **反復**
   - 次のモジュールへ進む

### 5.3 進捗管理

- **タスク管理**: 各モジュールの実装状況を追跡
- **マイルストーン**: 各フェーズの完了基準を設定
- **定期的なレビュー**: 設計と実装の整合性を確認

## まとめ

AIとの共同開発は、明確なコミュニケーションと段階的な開発アプローチによって効率化できます。モジュール単位での開発と適切なフィードバックサイクルを通じて、高品質なコードを効率的に作成しましょう。

特に以下の点を意識することで、効果的な共同作業が可能になります：

1. **明確な要件と設計の共有**
2. **テスト駆動開発の実践**
3. **段階的な実装とフィードバック**
4. **モジュール間の依存関係を考慮した開発順序**
5. **定期的なコード品質のレビュー**

このガイドに従うことで、AI支援による効率的な開発プロセスを実現し、人狼ゲームGM支援ライブラリの開発を成功に導くことができるでしょう。
